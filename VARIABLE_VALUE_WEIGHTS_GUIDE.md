# ë³€ìˆ˜ ê°’ ê¸°ë°˜ ê°€ì¤‘ì¹˜ (Variable Value Weights) ì‚¬ìš© ê°€ì´ë“œ

## ğŸ“ ê°œìš”

ê° **ë³€ìˆ˜ ê°’ ìì²´ë³„ë¡œ** ì¤‘ìš”ë„ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

ì˜ˆ: ë³€ìˆ˜ê°€ `['top/u_cpu/decode/pipe_4', 'top/u_cpu/decode/pipe_5', 'top/u_cpu/decode/pipe_5']`ì¼ ë•Œ
- `pipe_4`ëŠ” ë§¤ìš° ì¤‘ìš” â†’ 3ë°°
- `pipe_5`ëŠ” ëœ ì¤‘ìš” â†’ 1ë°°

## ğŸ¯ ì„¤ì • ë°©ë²•

### ê¸°ë³¸ ì„¤ì •

```json
{
  "RULE_XXX": {
    "eps": 0.2,
    "variable_value_weights": {
      "top/u_cpu/decode/pipe_4": 3,
      "top/u_cpu/decode/pipe_5": 1
    }
  }
}
```

## ğŸ“Š ë™ì‘ ì›ë¦¬

### Step 1: ë³€ìˆ˜ ì¶”ì¶œ
```
ë¡œê·¸: "4 of 4 Signal 'top/u_cpu/decode/pipe_4' float Signal 'top/u_cpu/decode/pipe_5' float 'top/u_cpu/decode/pipe_5' signal conflicted"

ë³€ìˆ˜ ì¶”ì¶œ:
  ['top/u_cpu/decode/pipe_4', 'top/u_cpu/decode/pipe_5', 'top/u_cpu/decode/pipe_5']
```

### Step 2: ë³€ìˆ˜ ê°’ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ì ìš©
```
ì„¤ì •:
  pipe_4 â†’ weight 3ë°°
  pipe_5 â†’ weight 1ë°°

ê²°ê³¼:
  ['pipe_4', 'pipe_4', 'pipe_4', 'pipe_5', 'pipe_5']
  (pipe_4ëŠ” 3íšŒ, pipe_5ëŠ” 2íšŒ ë°˜ë³µ)
```

### Step 3: Embedding ìƒì„±
```
ì…ë ¥: "Template ... pipe_4 pipe_4 pipe_4 pipe_5 pipe_5"
                    â†‘ pipe_4ê°€ 3ë°°ë¡œ ê°•ì¡°ë¨
```

## ğŸ’¡ ì‹¤ì œ ì‚¬ìš© ì‚¬ë¡€

### ì‚¬ë¡€ 1: íŒŒì´í”„ ë²ˆí˜¸ ìš°ì„ ë„

```json
{
  "RULE_PIPE_CONFLICT": {
    "eps": 0.2,
    "variable_value_weights": {
      "top/u_cpu/decode/pipe_4": 4,
      "top/u_cpu/decode/pipe_5": 1,
      "top/u_cpu/decode/pipe_6": 1
    },
    "description": "pipe_4ëŠ” ë§¤ìš° ì¤‘ìš”, ë‚˜ë¨¸ì§€ëŠ” ë¬´ì‹œ"
  }
}
```

### ì‚¬ë¡€ 2: ë©”ëª¨ë¦¬ ì£¼ì†Œ ê·¸ë£¹í™”

```json
{
  "RULE_MEMORY_ACCESS": {
    "eps": 0.18,
    "variable_value_weights": {
      "0x8000_0000": 5,
      "0x9000_0000": 3,
      "0xa000_0000": 1
    },
    "description": "íŠ¹ì • ë©”ëª¨ë¦¬ ì˜ì—­ì´ ì¤‘ìš”"
  }
}
```

### ì‚¬ë¡€ 3: ê²½ë¡œ ê³„ì¸µ ìš°ì„ ë„

```json
{
  "RULE_ROUTING": {
    "eps": 0.2,
    "variable_value_weights": {
      "top/u_cpu/execute": 4,
      "top/u_cpu/decode": 2,
      "top/u_lsu": 1
    },
    "description": "execute ê²½ë¡œê°€ ê°€ì¥ ì¤‘ìš”"
  }
}
```

## âš™ï¸ íŒŒë¼ë¯¸í„° ì„¤ëª…

| íŒŒë¼ë¯¸í„° | íƒ€ì… | ì„¤ëª… | ê¸°ë³¸ê°’ |
|---------|------|------|-------|
| `variable_value_weights` | Object | ë³€ìˆ˜ ê°’ë³„ ê°€ì¤‘ì¹˜ | `null` |

### ê°ì²´ êµ¬ì¡°
```json
{
  "ë³€ìˆ˜ê°’1": ê°€ì¤‘ì¹˜1,
  "ë³€ìˆ˜ê°’2": ê°€ì¤‘ì¹˜2,
  ...
}
```

**ì˜ˆì‹œ:**
```json
{
  "top/u_cpu/decode/pipe_4": 3,
  "top/u_cpu/decode/pipe_5": 1,
  "other_var": 2
}
```

## ğŸ”„ variable_position_weightsì™€ì˜ ì°¨ì´

| ê¸°ëŠ¥ | variable_position_weights | variable_value_weights |
|------|--------------------------|------------------------|
| ì„¤ì • ëŒ€ìƒ | ë³€ìˆ˜ì˜ **ìœ„ì¹˜** (ì²«, ë‘˜, ì…‹...) | ë³€ìˆ˜ì˜ **ê°’** ìì²´ |
| íƒ€ì… | ë°°ì—´ [3, 2, 1] | ê°ì²´ {"var1": 3, "var2": 1} |
| ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ | ì²«ë²ˆì§¸ ë³€ìˆ˜ê°€ í•­ìƒ ì¤‘ìš” | íŠ¹ì • ë³€ìˆ˜ ê°’ì´ ì¤‘ìš” |
| ì˜ˆì‹œ | `[3, 1]` â†’ ì²« ë³€ìˆ˜ 3ë°° | `{"pipe_4": 3}` â†’ pipe_4ë§Œ 3ë°° |

## âœ… ì£¼ì˜ì‚¬í•­

1. **ì •í™•í•œ ë³€ìˆ˜ëª… í•„ìš”**
   - ì„¤ì •ì—ì„œ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ë³€ìˆ˜ëª…ë§Œ ì ìš©ë¨
   - ì˜ˆ: `"top/u_cpu/decode/pipe_4"` (ìŠ¤í˜ì´ìŠ¤ í¬í•¨ ì—¬ë¶€ í™•ì¸)

2. **ì§€ì •ë˜ì§€ ì•Šì€ ë³€ìˆ˜ëŠ” ê¸°ë³¸ê°’ 1**
   ```json
   {
     "pipe_4": 3
     // pipe_5ëŠ” ì„¤ì •ë˜ì§€ ì•Šì•„ì„œ 1ë°° (ê¸°ë³¸ê°’)
   }
   ```

3. **ë‹¤ì–‘í•œ í˜•íƒœì˜ ë³€ìˆ˜ ì§€ì›**
   ```json
   {
     // ê²½ë¡œ í˜•íƒœ
     "top/u_cpu/decode/pipe_4": 3,
     // ë©”ëª¨ë¦¬ ì£¼ì†Œ
     "0x8000": 4,
     // ë‹¨ìˆœ ë¬¸ì
     "high_priority": 5,
     // í˜¼í•©
     "module_v1.0": 2
   }
   ```

4. **ê³¼ë„í•œ ê°€ì¤‘ì¹˜ëŠ” embedding ì™œê³¡ ê°€ëŠ¥**
   - ê¶Œì¥: 1~5 ë²”ìœ„
   - 10 ì´ìƒì€ embedding spaceì—ì„œ ê³¼ë„í•˜ê²Œ ê°•ì¡°ë  ìˆ˜ ìˆìŒ

5. **ê·œì¹™ê³¼ ì¼ê´€ì„±**
   - ê°™ì€ rule ë‚´ì—ì„œ ë¹„ìŠ·í•œ ë³€ìˆ˜ë“¤ì€ ë¹„ìŠ·í•œ ê°€ì¤‘ì¹˜ ì‚¬ìš©
   - ì˜ˆ: pipe_4=3ì´ë©´ pipe_5ëŠ” 1~2 ì •ë„ê°€ ì ì ˆ

## ğŸš€ ê¶Œì¥ ì‚¬ìš© íŒ¨í„´

### íŒ¨í„´ 1: ìš°ì„ ìˆœìœ„ ê¸°ë°˜
```json
{
  "high_priority_var": 5,
  "medium_priority_var": 2,
  "low_priority_var": 1
}
```

### íŒ¨í„´ 2: ê³„ì¸µ ê¸°ë°˜
```json
{
  "top/level_1": 4,
  "top/level_2": 2,
  "top/level_3": 1
}
```

### íŒ¨í„´ 3: ë²”ìœ„ ê¸°ë°˜ (ê°™ì€ ê°€ì¤‘ì¹˜)
```json
{
  "0x0000_0000": 1,
  "0x1000_0000": 1,
  "0x8000_0000": 5,
  "0x9000_0000": 5
}
```

## ğŸ§ª í…ŒìŠ¤íŠ¸

ë³€ìˆ˜ ê°’ ê¸°ë°˜ ê°€ì¤‘ì¹˜ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸:
```bash
python3 test_variable_value_weights.py
```

## ğŸ“ˆ íš¨ê³¼ ë¹„êµ

### ì„¤ì • ì—†ìŒ
```json
{ "variable_value_weights": null }
```
â†’ ëª¨ë“  ë³€ìˆ˜ê°€ ë™ë“± â†’ ëœ ì •í™•í•œ clustering

### ê¸°ë³¸ ì„¤ì •
```json
{ "variable_value_weights": {"pipe_4": 3, "pipe_5": 1} }
```
â†’ pipe_4 ì¤‘ì‹¬ clustering â†’ pipe_4ê°€ ê°™ìœ¼ë©´ ë³‘í•© ê°€ëŠ¥ì„± ë†’ìŒ â­

### ê°•í•œ ì„¤ì •
```json
{ "variable_value_weights": {"pipe_4": 5, "pipe_5": 1} }
```
â†’ pipe_4ì˜ ì˜í–¥ì´ ë§¤ìš° ê°•í•¨ â†’ pipe_5 ì°¨ì´ëŠ” ê±°ì˜ ë¬´ì‹œ

## ğŸ’¬ ìì£¼ ë¬»ëŠ” ì§ˆë¬¸

**Q: variable_position_weightsì™€ variable_value_weightsë¥¼ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆë‚˜ìš”?**
A: í˜„ì¬ëŠ” variable_value_weightsê°€ ìˆìœ¼ë©´ position ê¸°ë°˜ì€ ë¬´ì‹œë©ë‹ˆë‹¤. ë‘˜ ë‹¤ í•„ìš”í•˜ë©´ ì´ìŠˆ ë“±ë¡ ë¶€íƒí•©ë‹ˆë‹¤.

**Q: ì •ê·œì‹ íŒ¨í„´ì„ ì§€ì›í•˜ë‚˜ìš”?**
A: í˜„ì¬ëŠ” ì •í™•í•œ ë¬¸ìì—´ ë§¤ì¹­ë§Œ ì§€ì›í•©ë‹ˆë‹¤. ì •ê·œì‹ì´ í•„ìš”í•˜ë©´ ì´ìŠˆ ë“±ë¡ ë¶€íƒí•©ë‹ˆë‹¤.

**Q: ë³€ìˆ˜ ê°œìˆ˜ê°€ ë§ìœ¼ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?**
A: ë³€ìˆ˜ ê°œìˆ˜ì™€ ê´€ê³„ì—†ì´ ì„¤ì •ëœ ê°’ë“¤ë§Œ í•´ë‹¹ ê°€ì¤‘ì¹˜ê°€ ì ìš©ë˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ê¸°ë³¸ê°’ 1ì…ë‹ˆë‹¤.
